<!DOCTYPE html>




<html
 dir="ltr"
 lang="en"
 >
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content=#ffffff>
    <link rel="stylesheet" href="/assets/css/app.css">

    <!--Bailey3D: Added Magnific popup-->
    <link rel="stylesheet" href="/assets/css/magnific-popup.css">

    <!--Bailey3D: Added twentytwenty (image comparison)-->
    <link rel="stylesheet" href="/assets/css/twentytwenty.css" type="text/css" media="screen" />

    <!--Bailey3D: Added splide-->
    <link rel="stylesheet" href="/assets/packages/splide.min.css" type="text/css" media="screen" />
    <!--<link rel="stylesheet" href="/assets/packages/splide-default.min.css" type="text/css" media="screen" />-->

    <link rel="shortcut icon" type="image/png"
           href="https://assets.bailey3d.com/website.assets/icon.png" 
    />
    <script defer src="https://unpkg.com/alpinejs@3.9.0/dist/cdn.min.js"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">
    
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma-social@1/bin/bulma-social.min.css">
    
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>HLSL Shader Library In Unreal | Bailey3D</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="HLSL Shader Library In Unreal" />
<meta name="author" content="Bailey Martin" />
<meta property="og:locale" content="en" />
<meta name="description" content="Python based tool used to automate generation of .USF files from external HLSL Libraries" />
<meta property="og:description" content="Python based tool used to automate generation of .USF files from external HLSL Libraries" />
<link rel="canonical" href="http://0.0.0.0:4000/2020/10/30/ue4_shader_tools/" />
<meta property="og:url" content="http://0.0.0.0:4000/2020/10/30/ue4_shader_tools/" />
<meta property="og:site_name" content="Bailey3D" />
<meta property="og:image" content="https://github.com/Bailey3D-Website/2021/blob/main/projects/HLSL%20Library/thumb.png?raw=true" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-10-30T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://github.com/Bailey3D-Website/2021/blob/main/projects/HLSL%20Library/thumb.png?raw=true" />
<meta property="twitter:title" content="HLSL Shader Library In Unreal" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Bailey Martin"},"dateModified":"2020-10-30T00:00:00+00:00","datePublished":"2020-10-30T00:00:00+00:00","description":"Python based tool used to automate generation of .USF files from external HLSL Libraries","headline":"HLSL Shader Library In Unreal","image":"https://github.com/Bailey3D-Website/2021/blob/main/projects/HLSL%20Library/thumb.png?raw=true","mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/2020/10/30/ue4_shader_tools/"},"url":"http://0.0.0.0:4000/2020/10/30/ue4_shader_tools/"}</script>
<!-- End Jekyll SEO tag -->

    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-YBL8T39XKG"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YBL8T39XKG');
</script>
<!-- head scripts -->
<script src="/assets/js/main.min.js"></script>

<!--Bailey3D: Added jQuery-->
<script src="/assets/js/jquery.min.js" type="text/javascript"></script>
<script src="/assets/js/jquery.fitvids.js" type="text/javascript"></script>

<!--Bailey3D: Added Magnific popup-->
<script src="/assets/js/jquery.magnific-popup.min.js" type="text/javascript"></script>

<!--Bailey3D: Added twentytwenty (image comparison)-->
<script src="/assets/js/jquery.event.move.js" type="text/javascript"></script>
<script src="/assets/js/jquery.twentytwenty.js" type="text/javascript"></script>

<!--Bailey3D: Added Splide-->
<script src="/assets/packages/splide.min.js" type="text/javascript"></script>
</head>

  <body>
    <nav class="navbar is-primary " x-data="{ openNav: false }">
    <div class="container">


        <div class="navbar-brand">

            <div style="display: flex; justify-content: center; align-items: center;">
                
                    <a class="site-logo" href="/"><img src="https://assets.bailey3d.com/website.assets/icon.png" style="max-width: 32px; max-height: 32px;"></a>
                
            </div>

            <a href="/" class="navbar-item">
                Bailey3D
            </a>
            <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navMenu" :class="{ 'is-active': openNav }" x-on:click="openNav = !openNav">
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
            </a>
        </div>

        <div class="navbar-menu" id="navMenu" :class="{ 'is-active': openNav }">
            <div class="navbar-start">
                <a href="/" class="navbar-item ">Home</a>
                
                
                    
                    <a href="/blog/" class="navbar-item ">Blog</a>
                    
                
                    
                    <a href="/store/" class="navbar-item ">Store</a>
                    
                
                    
                    <div class="navbar-item has-dropdown is-hoverable ">
                        <a href="" class="navbar-link ">Docs</a>
                        <div class="navbar-dropdown">
                            
                            <a href="/docs/SketchIt/index/" class="navbar-item ">SketchIt</a>
                            
                            <a href="/docs/RetroFiltersPack/index/" class="navbar-item ">Retro Filters Pack</a>
                            
                            <a href="/docs/Juniper/index/" class="navbar-item ">Juniper</a>
                            
                        </div>
                    </div>
                    
                
                
            </div>

            <div class="navbar-end">
                
            </div>

        </div>
    </div>
</nav>

    
        <!--
:desc Page used as the hero banner for a page - with info on the name/docs
:desc for store pages this will include price and rating
:desc for blog pages this will include tags and author
-->




<!--
store properties
-->



<section class="hero  is-large  is-bold is-primary"  style="background: url('https://github.com/Bailey3D-Website/2021/blob/main/projects/HLSL%20Library/thumb.png?raw=true') no-repeat center center; background-size: cover;" >
    <div class="hero-body  dark ">
        <div class="container">

            
                <h1 class="title is-2">HLSL Shader Library In Unreal</h1>
            

            <p class="subtitle is-3"></p>
            

            
                <p>Published: Oct 30, 2020 by Bailey Martin</p>
            

            <div>

                
                    

                    
                


                

                
                    <a class="button is-secondary"><i>Unreal</i></a>
                
                    <a class="button is-secondary"><i>HLSL</i></a>
                
                    <a class="button is-secondary"><i>Python</i></a>
                
                    <a class="button is-secondary"><i>Assets</i></a>
                
                    <a class="button is-secondary"><i>Tools</i></a>
                
                    <a class="button is-secondary"><i>Pipeline</i></a>
                
                    <a class="button is-secondary"><i>Shaders</i></a>
                

                

            </div>

            


        </div>
    </div>
</section>


    
    <section class="section">
        <div class="container">
            <div class="columns is-multiline">
                
                <div class="column is-8">
                    

                    <div class="content">

    <!--<p>Published: Oct 30, 2020 by Bailey Martin</p>-->

    

    <p>As someone who has experience with using HLSL for shader coding, the lack of HLSL support in Unreal has always frustrated me.</p>

<p>This Python library aims to add some rudimentary support for using external HLSL libraries from within Unreal Material Graphs, using a mix of techniques listed below.</p>

<h3 id="whats-the-aim">What’s the Aim?</h3>
<section id="what_is" />

<p>The aim with this is to be able to use an external library containing individual ‘.HLSL’ files inside of unreal, using <code class="language-plaintext highlighter-rouge">#include</code> from inside a custom node.
But before we can do that there are a few hurdles that need to be addressed:</p>

<p><strong>1</strong> - Unreal doesn’t support custom Shader #includes by default <br />
<strong>2</strong> - All shaders must be inside the current project’s “project/shaders” directory to be usable <br />
<strong>3</strong> - All shader files must be in ‘.USF’ or ‘.USH’ format - ‘.HLSL’ is not allowed <br />
<strong>4</strong> - Unreal ‘Custom’ nodes require all functions to be within some sort of scope <br /></p>

<hr />

<h3 id="supporting-external-shader-includes-in-unreal">Supporting External Shader Includes in Unreal:</h3>
<section id="includes" />

<p>The first issue comes with the fact that Unreal by default doesn’t enable #including “project/shaders” directory inside of custom nodes - trying to include them will cause a compiler error.</p>

<p>To fix this we’ll need to add in a search path for the shaders. I’ve done this in a plugin since that’s where all of my shaders are stored, but this will work just as well inside of your <code class="language-plaintext highlighter-rouge">ProjectName.h</code> and <code class="language-plaintext highlighter-rouge">ProjectName.cpp</code> files.</p>

<p>This is relatively simple, and just requires us to add an extra Shader Source Directory Mapping to the project.
You can see how I’ve set this up in the code below. In my case there is some extra code for reading the path from the Registry, but that can be omitted if you’re using a static path.</p>

<script src="https://gist.github.com/Bailey3D/4786196223ed5e136239958d81c370dc.js"></script>

<script src="https://gist.github.com/Bailey3D/2aa821a85a313c02a3060137aa8dd26f.js"></script>

<p>All being well, this should allow you to #include ‘.USH’ and ‘.USF’ files in your Project/Plugin Shaders directory.</p>

<h3 id="creating-a-library-watchdog">Creating a Library ‘Watchdog’</h3>
<section id="watchdog" />

<p>The second hurdle comes from the fact that all shaders must be inside of the “project/shaders” directory. While it’s not technically true that they won’t work in an external directory, the fact that all files have to be ‘.USH’ or ‘.USF’ files means that integrating it into a raw ‘.HLSL’ library will get messy fast.</p>

<p>For this reason, I’ve created a python library to create a folder watcher on our external ‘pure’ HLSL library, which watches for any and all file changes, and copies the files over to the project’s Shaders library.</p>

<p>Since this isn’t a tutorial, I’ll post links to the source files at the end of this section if you’d like to take a look at how it’s done. But the general overview is:</p>

<p><strong>- On Engine Startup:</strong> Sets off a script which watches for changes to files in the external library <br />
<strong>- On Change Detected:</strong> Copies all files from the external library to the project’s Shaders directory <br />
<strong>- Convert to USF:</strong> covered in the next section, but this is required since .HLSL cannot be used in Unreal <br /></p>

<p>Example source files can be found here: <a href="https://github.com/Bailey3D/Juniper/blob/main/lib/python/juniper/framework/types/folder_watcher.py" target="_blank">folder_watcher.py</a> <b>+</b> 
<a href="https://github.com/Bailey3D/Juniper-AssetLibrary/blob/main/scripts/ue4/startup/1/shader_source_watcher.py" target="_blank">shader_source_watcher.py</a> <b>+</b> 
<a href="https://github.com/Bailey3D/Juniper-AssetLibrary/blob/main/lib/python/asset_library/programs/ue4/asset_management/shaders.py" target="_blank">shaders.py</a></p>

<h3 id="converting-hlsl-to-usf">Converting .HLSL to .USF</h3>
<section id="converting" />

<p>A bit of a continuation of the previous point. But since Unreal doesn’t support ‘.HLSL’ files, we’ll need to convert all references to ‘.HLSL’ over to ‘.USH’</p>

<p>This is done as part of the conversion scripts, it pretty much has two steps: <br />
<strong>1 - Change File Type:</strong> Replace the ‘.hlsl’ file extension with ‘.ush’ <br />
<strong>2 - Replace in Files:</strong> Convert all ‘.hlsl’ #includes to ‘.ush’ includes <br /></p>

<h3 id="creating-a-shader-library--function-scoping">Creating a Shader Library / Function Scoping</h3>
<section id="functions" />

<p>The last issue is that, everything inside of a ‘Custom’ node in unreal must be inside some sort of scope. The trouble comes down to how this is accessed. If you were to just treat it like a regular ‘.HLSL’ file by creating them in the scope of the main file, unreal will throw a compiler error.</p>

<p>I get around this by storing everything within a ‘struct’. It can be as simple as creating a struct with everything inside and then instancing the struct. But that’s still a bit fiddly.</p>

<p>Instead we can use the HLSL preprocessor to automatically create the instance of the struct. It’s a bit of a hack, but works nicely once you’re used to setting it up.</p>

<p>To do this I have a file ‘ defines.hlsl’ which contains a macro called ‘container’. A container is essentially treated like a namespace or singleton (albeit a bit more limited):</p>

<script src="https://gist.github.com/Bailey3D/482b687fb6a4588adb6abae328526f0a.js"></script>

<p>And here’s an example of how a container is populated, and how to call the generated container:</p>

<script src="https://gist.github.com/Bailey3D/f6dc98c141012f90a19bdaa576828bc6.js"></script>

<script src="https://gist.github.com/Bailey3D/ef9ee1c353decc5e6f449b565ca3ed32.js"></script>

<hr />
<section id="conclusion" />

<p>And that’s it - this has allowed me to essentially #include and use data from inside of an external HLSL library directly from Unreal. It’s a bit convoluted, but is better than coding directly inside of the Custom nodes, or having to create an actual engine side shader.</p>

<p>I do hope Unreal gets some better shader coding support in the future, I’d love to be able to use HLSL more than just through a custom node and without all these hacks. But until then, I’ll be using this method.</p>

</div>

<div class="tags">
    
      <span class="tag  is-primary ">
    Unreal
</span>

    
      <span class="tag  is-primary ">
    HLSL
</span>

    
      <span class="tag  is-primary ">
    Python
</span>

    
      <span class="tag  is-primary ">
    Assets
</span>

    
      <span class="tag  is-primary ">
    Tools
</span>

    
      <span class="tag  is-primary ">
    Pipeline
</span>

    
      <span class="tag  is-primary ">
    Shaders
</span>

    
</div>


<p><strong>Share</strong></p>
<div class="buttons ">
    <a class="button is-medium is-facebook"
       onclick="window.open('https://www.facebook.com/share.php?u=http://0.0.0.0:4000/2020/10/30/ue4_shader_tools/');">
        <span class="icon"><i class="fab fa-facebook fa-lg"></i></span>
    </a>
    <a class="button is-medium is-twitter"
       onclick="window.open('https://twitter.com/intent/tweet?text=http://0.0.0.0:4000/2020/10/30/ue4_shader_tools/');">
        <span class="icon"><i class="fab fa-twitter fa-lg"></i></span>
    </a>
    <a class="button is-medium is-linkedin"
       onclick="window.open('https://www.linkedin.com/shareArticle?mini=true&url=http://0.0.0.0:4000/2020/10/30/ue4_shader_tools/&title=HLSL+Shader+Library+In+Unreal&summary=&source=');">
        <span class="icon"><i class="fab fa-linkedin fa-lg"></i></span>
    </a>
    <a class="button is-medium is-reddit"
       onclick="window.open('https://reddit.com/submit?url=http://0.0.0.0:4000/2020/10/30/ue4_shader_tools/');">
        <span class="icon"><i class="fab fa-reddit fa-lg"></i></span>
    </a>
</div>




                </div>
                
                <div class="column is-4-desktop is-4-tablet">
                    <!--
:desc Vertical list of all top store products (small)
-->

    <p class="title is-4">Store</p>


<div class="columns is-multiline">

    
        
            
        
            
        
            
        
            
                <div class="column is-12">
                    <!--
:desc This file is used as a template for a product widget
-->




<div class="card">
    
    <div class="card-image">
        <a href="/products/retro_filters_pack/">
            <img src="https://github.com/Bailey3D-Website/2021/blob/main/packages/RetroFiltersPack/Images/Gallery/gallery_main.jpg?raw=true" alt="Retro Filters Pack">
        </a>
    </div>
    
    <div class="card-content">
        <div class="content">
            
            <a class="title is-4" href="/products/retro_filters_pack/">Retro Filters Pack</a>
            
            
            <p>Pack containing filters for VHS / Glitch, CRT Monitor, Vintage, Pixelate, Retro Console, Arcade Machine, and more..</p>

            
        </div>

        

        <div>
            
                <a href="/products/retro_filters_pack/" class="button is-primary">$39.99</a>
            

            
                <a href="/products/retro_filters_pack/" class="button is-secondary">Unreal</a>
            
                <a href="/products/retro_filters_pack/" class="button is-secondary">Shaders</a>
            
        </div>

    </div>
</div>

                </div>
            
        
            
        
    
        
            
                <div class="column is-12">
                    <!--
:desc This file is used as a template for a product widget
-->




<div class="card">
    
    <div class="card-image">
        <a href="/products/iridescent_materials/">
            <img src="https://github.com/Bailey3D-Website/2021/blob/main/packages/IridescentMaterials/featured.jpg?raw=true" alt="Iridescent Materials Pack">
        </a>
    </div>
    
    <div class="card-content">
        <div class="content">
            
            <a class="title is-4" href="/products/iridescent_materials/">Iridescent Materials Pack</a>
            
            
            <p>Pearlescent, Bubbles, Iridescent Paint</p>

            
        </div>

        
            
            
    <div class="content left">
        
        <span class="icon">
            <i class="fas fa-star"></i>
        </span>
        
        <span class="icon">
            <i class="fas fa-star"></i>
        </span>
        
        <span class="icon">
            <i class="fas fa-star"></i>
        </span>
        
        <span class="icon">
            <i class="fas fa-star"></i>
        </span>
        
        <span class="icon">
            <i class="fas fa-star"></i>
        </span>
        
        
        
    </div>

        

        <div>
            
                <a href="/products/iridescent_materials/" class="button is-primary">$24.99</a>
            

            
                <a href="/products/iridescent_materials/" class="button is-secondary">Unreal</a>
            
                <a href="/products/iridescent_materials/" class="button is-secondary">Shaders</a>
            
        </div>

    </div>
</div>

                </div>
            
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
            
                <div class="column is-12">
                    <!--
:desc This file is used as a template for a product widget
-->




<div class="card">
    
    <div class="card-image">
        <a href="/products/sketch_it/">
            <img src="https://github.com/Bailey3D-Website/2021/blob/main/packages/SketchIt/featured.jpg?raw=true" alt="Sketch-It">
        </a>
    </div>
    
    <div class="card-content">
        <div class="content">
            
            <a class="title is-4" href="/products/sketch_it/">Sketch-It</a>
            
            
            <p>Hand Drawn Post Process Pack</p>

            
        </div>

        
            
            
    <div class="content left">
        
        <span class="icon">
            <i class="fas fa-star"></i>
        </span>
        
        <span class="icon">
            <i class="fas fa-star"></i>
        </span>
        
        <span class="icon">
            <i class="fas fa-star"></i>
        </span>
        
        <span class="icon">
            <i class="fas fa-star"></i>
        </span>
        
        <span class="icon">
            <i class="fas fa-star"></i>
        </span>
        
        
        
    </div>

        

        <div>
            
                <a href="/products/sketch_it/" class="button is-primary">$23.99</a>
            

            
                <a href="/products/sketch_it/" class="button is-secondary">Unreal</a>
            
                <a href="/products/sketch_it/" class="button is-secondary">Shaders</a>
            
        </div>

    </div>
</div>

                </div>
            
        
    
        
            
        
            
                <div class="column is-12">
                    <!--
:desc This file is used as a template for a product widget
-->




<div class="card">
    
    <div class="card-image">
        <a href="/products/mesh_splitter/">
            <img src="https://github.com/Bailey3D-Website/2021/blob/main/packages/MeshSplitter/featured.jpg?raw=true" alt="Mesh Splitter">
        </a>
    </div>
    
    <div class="card-content">
        <div class="content">
            
            <a class="title is-4" href="/products/mesh_splitter/">Mesh Splitter</a>
            
            
            

            
        </div>

        

        <div>
            
                <a href="/products/mesh_splitter/" class="button is-primary">Free</a>
            

            
                <a href="/products/mesh_splitter/" class="button is-secondary">3DS Max</a>
            
                <a href="/products/mesh_splitter/" class="button is-secondary">Tools</a>
            
        </div>

    </div>
</div>

                </div>
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
                <div class="column is-12">
                    <!--
:desc This file is used as a template for a product widget
-->




<div class="card">
    
    <div class="card-image">
        <a href="/products/quick_merge_selection/">
            <img src="https://github.com/Bailey3D-Website/2021/blob/main/packages/MergeSelection/featured.jpg?raw=true" alt="Quick Merge Selection">
        </a>
    </div>
    
    <div class="card-content">
        <div class="content">
            
            <a class="title is-4" href="/products/quick_merge_selection/">Quick Merge Selection</a>
            
            
            

            
        </div>

        

        <div>
            
                <a href="/products/quick_merge_selection/" class="button is-primary">Free</a>
            

            
                <a href="/products/quick_merge_selection/" class="button is-secondary">3DS Max</a>
            
                <a href="/products/quick_merge_selection/" class="button is-secondary">Tools</a>
            
        </div>

    </div>
</div>

                </div>
            
        
            
        
            
        
    
</div>

<div class="has-text-centered">
    <a href="/store/" class="button is-primary">See All Products..</a>
</div>



                </div>
                
            </div>
        </div>
    </section>
    
        <footer class="footer">
    <div class="container">
        
        
        <div class="columns is-multiline">
            
        </div>
        

        <div class="content is-small has-text-centered">
            <p class="">Copyright © <a href="https://www.bailey3d.com">Bailey Martin 2025</a></p>
        </div>
    </div>
</footer>

    
    <script src="/assets/js/app.js" type="text/javascript"></script><!-- footer scripts -->
</body>
</html>
